<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sp√•rplanV2 - Professionell T√•gtrafikledning</title>
    
    <!-- 1. Design System Foundation -->
    <link rel="stylesheet" href="styles/design-system.css">
    <link rel="stylesheet" href="styles/typography.css">
    <link rel="stylesheet" href="styles/variables.css">
    
    <!-- 2. Themes -->
    <link rel="stylesheet" href="styles/themes.css">
    
    <!-- 3. Base & Layout -->
    <link rel="stylesheet" href="styles/base.css">
    
    <!-- 4. Components -->
    <link rel="stylesheet" href="styles/components/buttons.css">
    <link rel="stylesheet" href="styles/components/header.css">
    <link rel="stylesheet" href="styles/components/logo.css">
    <link rel="stylesheet" href="styles/components/schedule.css">
    <link rel="stylesheet" href="styles/components/tracks.css">
    <link rel="stylesheet" href="styles/components/timeline.css">
    <link rel="stylesheet" href="styles/components/trains.css">
    
    <style>
        /* Temporary demo styles to show off our design system */
        .demo-container {
            padding: var(--spacing-8);
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .demo-section {
            margin-bottom: var(--spacing-12);
            padding: var(--spacing-6);
            background: var(--surface-primary);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-md);
        }
        
        .demo-section h2 {
            color: var(--text-primary);
            margin-bottom: var(--spacing-4);
            border-bottom: 2px solid var(--border-primary);
            padding-bottom: var(--spacing-2);
        }
        
        .color-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: var(--spacing-4);
            margin-top: var(--spacing-4);
        }
        
        .color-swatch {
            height: 80px;
            border-radius: var(--border-radius-md);
            display: flex;
            align-items: flex-end;
            padding: var(--spacing-2);
            font-size: var(--font-size-sm);
            color: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
            box-shadow: var(--shadow-sm);
        }
        
        .button-demo {
            display: flex;
            gap: var(--spacing-4);
            flex-wrap: wrap;
            margin-top: var(--spacing-4);
        }
        
        .btn {
            padding: var(--spacing-3) var(--spacing-6);
            border: none;
            border-radius: var(--border-radius-md);
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            transition: all var(--transition-normal);
        }
        
        .btn-primary {
            background: var(--interactive-primary);
            color: var(--text-inverse);
        }
        
        .btn-primary:hover {
            background: var(--interactive-primary-hover);
            box-shadow: var(--shadow-lg);
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background: var(--interactive-secondary);
            color: var(--text-primary);
        }
        
        .btn-secondary:hover {
            background: var(--interactive-secondary-hover);
        }
        
        .btn-success {
            background: var(--success-600);
            color: white;
        }
        
        .btn-success:hover {
            background: var(--success-700);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-warning {
            background: var(--warning-500);
            color: white;
        }
        
        .btn-warning:hover {
            background: var(--warning-600);
        }
        
        .btn-danger {
            background: var(--interactive-danger);
            color: white;
        }
        
        .btn-danger:hover {
            background: var(--interactive-danger-hover);
        }
        
        .typography-demo p {
            margin: var(--spacing-2) 0;
        }
        
        .theme-toggle {
            position: fixed;
            top: var(--spacing-4);
            right: var(--spacing-4);
            z-index: 1000;
            padding: var(--spacing-3) var(--spacing-5);
            background: var(--surface-elevated);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-xl);
            display: flex;
            gap: var(--spacing-3);
        }
        
        .theme-btn {
            padding: var(--spacing-2) var(--spacing-4);
            border: 2px solid var(--border-primary);
            background: var(--surface-secondary);
            border-radius: var(--border-radius-md);
            cursor: pointer;
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            transition: all var(--transition-fast);
        }
        
        .theme-btn:hover {
            background: var(--interactive-primary);
            color: white;
            border-color: var(--interactive-primary);
        }
        
        .theme-btn.active {
            background: var(--interactive-primary);
            color: white;
            border-color: var(--interactive-primary);
        }
        
        .spacing-demo {
            display: flex;
            gap: var(--spacing-2);
            flex-wrap: wrap;
            margin-top: var(--spacing-4);
        }
        
        .spacing-box {
            background: var(--primary-200);
            border: 2px solid var(--primary-600);
            border-radius: var(--border-radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-bold);
            color: var(--primary-800);
        }
    </style>
</head>
<body>
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-to-main">Hoppa till huvudinneh√•ll</a>
    
    <!-- Main Application Header -->
    <header class="app-header" role="banner">
        <!-- Left Section: Logo & Title -->
        <div class="header-left">
            <a href="/" class="header-logo">
                <img src="assets/logo.png" alt="Sp√•rplanV2 Logo" class="app-logo">
                <div>
                    <h1 class="header-title">Sp√•rplanV2</h1>
                    <p class="header-subtitle">Professionell T√•gtrafikledning</p>
                </div>
            </a>
        </div>
        
        <!-- Center Section: Time Controls -->
        <nav class="header-center" aria-label="Tidskontroller">
            <div class="time-controls">
                <div class="time-nav">
                    <button class="btn btn-secondary btn-icon" aria-label="F√∂reg√•ende timme" title="F√∂reg√•ende timme">
                        <span style="font-size: 18px;">‚Üê</span>
                    </button>
                </div>
                
                <div class="time-display">
                    <div class="time-display-current" id="current-time-display">14:30</div>
                    <div class="time-display-range" id="time-range-display">14:00 - 18:00</div>
                </div>
                
                <button class="btn btn-primary btn-now" id="now-button">
                    <span>Nu</span>
                </button>
                
                <div class="time-nav">
                    <button class="btn btn-secondary btn-icon" aria-label="N√§sta timme" title="N√§sta timme">
                        <span style="font-size: 18px;">‚Üí</span>
                    </button>
                </div>
                
                <div class="time-range-selector">
                    <button class="btn btn-secondary btn-sm time-range-button" id="time-range-btn" aria-label="V√§lj tidsintervall">
                        <span>4h</span>
                    </button>
                    <div class="time-range-dropdown" id="time-range-dropdown">
                        <div class="time-range-option" data-hours="1">1 timme</div>
                        <div class="time-range-option" data-hours="3">3 timmar</div>
                        <div class="time-range-option active" data-hours="4">4 timmar</div>
                        <div class="time-range-option" data-hours="6">6 timmar</div>
                        <div class="time-range-option" data-hours="8">8 timmar</div>
                        <div class="time-range-option" data-hours="12">12 timmar</div>
                    </div>
                </div>
            </div>
        </nav>
        
        <!-- Right Section: Status & Settings -->
        <div class="header-right">
            <div class="status-badge connected" id="api-status" title="API-status">
                <span class="status-badge-text">Ansluten</span>
            </div>
            
            <button class="btn btn-icon theme-toggle" id="theme-toggle-btn" aria-label="Byt tema" title="Byt tema">
                <span style="font-size: 20px;">üåì</span>
            </button>
            
            <button class="btn btn-icon settings-button" aria-label="Inst√§llningar" title="Inst√§llningar">
                <span style="font-size: 20px;">‚öôÔ∏è</span>
            </button>
        </div>
    </header>

      <!-- Main Content -->
      <main id="main-content" style="margin-top: var(--header-height); padding: var(--spacing-8);">
          
          <!-- Schedule View - Subfas 1.3 -->
          <div class="schedule-container" id="schedule-container" role="region" aria-label="T√•gschema">
              <!-- Corner cell -->
              <div class="schedule-corner">Sp√•r</div>
              
              <!-- Timeline header -->
              <div class="schedule-timeline-header">
                  <div class="timeline-hours" id="timeline-hours">
                      <!-- Dynamically generated time markers -->
                  </div>
              </div>
              
              <!-- Track labels -->
              <div class="schedule-track-labels" id="track-labels">
                  <!-- Dynamically generated track rows -->
              </div>
              
              <!-- Timeline grid area -->
              <div class="schedule-grid-area" id="schedule-grid">
                  <div class="timeline-canvas" id="timeline-canvas">
                      <div class="timeline-grid" id="timeline-grid">
                          <!-- Grid lines generated dynamically -->
                      </div>
                      <!-- Train bars generated dynamically -->
                      <div class="timeline-current-time" id="current-time-line"></div>
                  </div>
              </div>
              
              <div class="schedule-scroll-hint">‚Üê Scrolla horisontellt ‚Üí</div>
          </div>
          
          <div class="demo-container" style="margin-top: var(--spacing-8)">
        <div style="text-align: center; margin-bottom: var(--spacing-8);">
            <h2 style="font-size: var(--font-size-2xl); color: var(--text-primary); margin-bottom: var(--spacing-2);">
                Design System Demo
            </h2>
            <p style="font-size: var(--font-size-base); color: var(--text-secondary);">
                Nu med professionell header & navigation!
            </p>
        </div>

        <!-- Typography Demo -->
        <section class="demo-section">
            <h2>üìù Typography System</h2>
            <div class="typography-demo">
                <h1 style="margin: var(--spacing-3) 0;">H1: Huvudrubrik (3xl - 30px)</h1>
                <h2 style="margin: var(--spacing-3) 0;">H2: Sekund√§r rubrik (2xl - 24px)</h2>
                <h3 style="margin: var(--spacing-3) 0;">H3: Underrubrik (xl - 20px)</h3>
                <p style="font-size: var(--font-size-lg);">Large body text (lg - 18px)</p>
                <p style="font-size: var(--font-size-base);">Normal body text (base - 16px) - Detta √§r standard text-storlek</p>
                <p style="font-size: var(--font-size-sm); color: var(--text-secondary);">Small text (sm - 14px) - Anv√§nds f√∂r mindre viktig information</p>
                <p style="font-size: var(--font-size-xs); color: var(--text-tertiary);">Extra small text (xs - 12px) - Metadata och timestamps</p>
            </div>
        </section>

        <!-- Color System Demo -->
        <section class="demo-section">
            <h2>üé® Color Palette</h2>
            
            <h3 style="margin-top: var(--spacing-6); margin-bottom: var(--spacing-3); color: var(--text-secondary);">Primary (Railway Blue)</h3>
            <div class="color-grid">
                <div class="color-swatch" style="background: var(--primary-500);">500 - Main</div>
                <div class="color-swatch" style="background: var(--primary-600);">600 - Primary</div>
                <div class="color-swatch" style="background: var(--primary-700);">700 - Hover</div>
                <div class="color-swatch" style="background: var(--primary-800);">800 - Active</div>
            </div>
            
            <h3 style="margin-top: var(--spacing-6); margin-bottom: var(--spacing-3); color: var(--text-secondary);">Semantic Colors</h3>
            <div class="color-grid">
                <div class="color-swatch" style="background: var(--success-600);">Success</div>
                <div class="color-swatch" style="background: var(--warning-500);">Warning</div>
                <div class="color-swatch" style="background: var(--error-600);">Error</div>
                <div class="color-swatch" style="background: var(--info-600);">Info</div>
            </div>
        </section>

        <!-- Buttons Demo -->
        <section class="demo-section">
            <h2>üîò Button System</h2>
            <div class="button-demo">
                <button class="btn btn-primary">Primary Button</button>
                <button class="btn btn-secondary">Secondary Button</button>
                <button class="btn btn-success">Success Button</button>
                <button class="btn btn-warning">Warning Button</button>
                <button class="btn btn-danger">Danger Button</button>
            </div>
        </section>

        <!-- Spacing Demo -->
        <section class="demo-section">
            <h2>üìè Spacing Scale (8px Grid System)</h2>
            <div class="spacing-demo">
                <div class="spacing-box" style="width: var(--spacing-2); height: var(--spacing-2);">2</div>
                <div class="spacing-box" style="width: var(--spacing-3); height: var(--spacing-3);">3</div>
                <div class="spacing-box" style="width: var(--spacing-4); height: var(--spacing-4);">4</div>
                <div class="spacing-box" style="width: var(--spacing-5); height: var(--spacing-5);">5</div>
                <div class="spacing-box" style="width: var(--spacing-6); height: var(--spacing-6);">6</div>
                <div class="spacing-box" style="width: var(--spacing-8); height: var(--spacing-8);">8</div>
                <div class="spacing-box" style="width: var(--spacing-10); height: var(--spacing-10);">10</div>
                <div class="spacing-box" style="width: var(--spacing-12); height: var(--spacing-12);">12</div>
            </div>
            <p style="margin-top: var(--spacing-4); color: var(--text-secondary); font-size: var(--font-size-sm);">
                Spacing-2 = 8px, Spacing-3 = 12px, Spacing-4 = 16px, Spacing-5 = 20px, Spacing-6 = 24px, Spacing-8 = 32px, etc.
            </p>
        </section>

        <!-- Shadow Demo -->
        <section class="demo-section">
            <h2>‚ú® Shadow System (Blur = 2√ó Distance)</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--spacing-6); margin-top: var(--spacing-4);">
                <div style="padding: var(--spacing-6); background: var(--surface-primary); border-radius: var(--border-radius-md); box-shadow: var(--shadow-sm);">
                    <strong>Shadow SM</strong><br>
                    <span style="font-size: var(--font-size-xs); color: var(--text-tertiary);">Subtle depth</span>
                </div>
                <div style="padding: var(--spacing-6); background: var(--surface-primary); border-radius: var(--border-radius-md); box-shadow: var(--shadow-md);">
                    <strong>Shadow MD</strong><br>
                    <span style="font-size: var(--font-size-xs); color: var(--text-tertiary);">Cards, panels</span>
                </div>
                <div style="padding: var(--spacing-6); background: var(--surface-primary); border-radius: var(--border-radius-md); box-shadow: var(--shadow-lg);">
                    <strong>Shadow LG</strong><br>
                    <span style="font-size: var(--font-size-xs); color: var(--text-tertiary);">Elevated elements</span>
                </div>
                <div style="padding: var(--spacing-6); background: var(--surface-primary); border-radius: var(--border-radius-md); box-shadow: var(--shadow-xl);">
                    <strong>Shadow XL</strong><br>
                    <span style="font-size: var(--font-size-xs); color: var(--text-tertiary);">Modals, dropdowns</span>
                </div>
            </div>
        </section>

        <!-- Status Indicator -->
        <section class="demo-section" style="text-align: center; background: linear-gradient(135deg, var(--success-50), var(--primary-50));">
            <h2 style="color: var(--success-700);">‚úÖ Design System Laddat!</h2>
            <p style="color: var(--text-secondary); margin-top: var(--spacing-2);">
                Alla CSS-filer √§r korrekt l√§nkade och ordnade. √ñppna Console (F12) f√∂r att verifiera inga errors.
            </p>
            <p style="color: var(--text-tertiary); font-size: var(--font-size-sm); margin-top: var(--spacing-4);">
                <strong>N√§sta steg:</strong> Implementera base.css och forts√§tt med layout-komponenter
            </p>
        </section>
    </div>

    <script>
        // Theme switcher
        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('sparplannen-theme', theme);
            console.log(`‚úÖ Theme switched to: ${theme}`);
        }
        
        // Initialize application
        window.addEventListener('DOMContentLoaded', () => {
            // Load saved theme
            const savedTheme = localStorage.getItem('sparplannen-theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            
            // Header functionality
            initializeHeader();
            
            // Update time display
            updateTimeDisplay();
            setInterval(updateTimeDisplay, 60000); // Update every minute
            
            // Initialize schedule view
            initializeSchedule();
            
            console.log('üé® Sp√•rplanV2 loaded successfully!');
            console.log('üìã CSS files loaded:');
            console.log('  1. design-system.css - schedule.css');
            console.log('  4. themes.css');
            console.log('  5. base.css');
            console.log('  6. components/*.css');
            console.log(`üåì Current theme: ${savedTheme}`);
        });
        
        // Schedule initialization with sample data
        function initializeSchedule() {
            const currentHour = new Date().getHours();
            const timeRange = 6; // Show 6 hours
            const pixelsPerHour = 200;
            
            // Sample tracks
            const tracks = [
                { id: 1, name: 'Sp√•r 1', type: 'main', length: 400 },
                { id: 2, name: 'Sp√•r 2', type: 'main', length: 380 },
                { id: 3, name: 'Sp√•r 3', type: 'side', length: 320 },
                { id: 4, name: 'Sp√•r 4', type: 'side', length: 280 },
                { id: 5, name: 'Sp√•r 5', type: 'main', length: 420 }
            ];
            
            // Sample trains
            const now = new Date();
            const trains = [
                { id: 1, number: 'SJ 301', type: 'regional', trackId: 1, 
                  arrTime: new Date(now.getFullYear(), now.getMonth(), now.getDate(), currentHour, 15),
                  depTime: new Date(now.getFullYear(), now.getMonth(), now.getDate(), currentHour + 1, 30),
                  origin: 'Stockholm C', dest: 'G√∂teborg C', status: 'on-time' },
                { id: 2, number: 'SJ 445', type: 'long-distance', trackId: 2,
                  arrTime: new Date(now.getFullYear(), now.getMonth(), now.getDate(), currentHour + 1, 0),
                  depTime: new Date(now.getFullYear(), now.getMonth(), now.getDate(), currentHour + 2, 45),
                  origin: 'Malm√∂ C', dest: 'Oslo S', status: 'delayed', hasConflict: true },
                { id: 3, number: 'GC 789', type: 'freight', trackId: 3,
                  arrTime: new Date(now.getFullYear(), now.getMonth(), now.getDate(), currentHour + 2, 10),
                  depTime: new Date(now.getFullYear(), now.getMonth(), now.getDate(), currentHour + 3, 15),
                  origin: 'G√∂teborg C', dest: 'Bor√•s', status: 'on-time' },
                { id: 4, number: 'SJ 102', type: 'regional', trackId: 1,
                  arrTime: new Date(now.getFullYear(), now.getMonth(), now.getDate(), currentHour + 3, 20),
                  depTime: new Date(now.getFullYear(), now.getMonth(), now.getDate(), currentHour + 4, 5),
                  origin: 'Halmstad C', dest: 'Stockholm C', status: 'on-time' },
                { id: 5, number: 'SJ 550', type: 'long-distance', trackId: 4,
                  arrTime: new Date(now.getFullYear(), now.getMonth(), now.getDate(), currentHour + 4, 30),
                  depTime: new Date(now.getFullYear(), now.getMonth(), now.getDate(), currentHour + 5, 20),
                  origin: 'K√∏benhavn H', dest: 'Stockholm C', status: 'on-time' }
            ];
            
            // Render timeline hours
            const timelineHours = document.getElementById('timeline-hours');
            for (let i = 0; i < timeRange; i++) {
                const hour = (currentHour + i) % 24;
                const hourDiv = document.createElement('div');
                hourDiv.className = 'timeline-hour' + (hour === currentHour ? ' current' : '');
                hourDiv.style.minWidth = pixelsPerHour + 'px';
                hourDiv.innerHTML = `
                    <span class="timeline-hour-label">${hour.toString().padStart(2, '0')}:00</span>
                `;
                timelineHours.appendChild(hourDiv);
            }
            
            // Render track labels
            const trackLabels = document.getElementById('track-labels');
            tracks.forEach(track => {
                const trackDiv = document.createElement('div');
                trackDiv.className = 'track-row';
                trackDiv.innerHTML = `
                    <div class="track-content">
                        <div class="track-name">${track.name}</div>
                        <div class="track-info">
                            <span class="track-type-badge ${track.type}">${track.type === 'main' ? 'Huvudsp√•r' : 'Sidosp√•r'}</span>
                            <span class="track-length">
                                <span class="track-length-icon"></span>
                                ${track.length}m
                            </span>
                        </div>
                    </div>
                `;
                trackLabels.appendChild(trackDiv);
            });
            
            // Render timeline track rows
            const timelineCanvas = document.getElementById('timeline-canvas');
            timelineCanvas.style.minWidth = (timeRange * pixelsPerHour) + 'px';
            timelineCanvas.style.height = (tracks.length * 64) + 'px';
            
            // Render grid lines
            const timelineGrid = document.getElementById('timeline-grid');
            for (let i = 0; i <= timeRange * 2; i++) {
                const gridLine = document.createElement('div');
                gridLine.className = 'timeline-grid-line' + (i % 2 === 0 ? ' hour' : ' half-hour');
                gridLine.style.left = (i * pixelsPerHour / 2) + 'px';
                timelineGrid.appendChild(gridLine);
            }
            
            // Add track row backgrounds
            tracks.forEach((track, index) => {
                const trackRow = document.createElement('div');
                trackRow.className = 'timeline-track-row';
                trackRow.style.top = (index * 64) + 'px';
                trackRow.style.width = '100%';
                trackRow.style.position = 'absolute';
                timelineCanvas.appendChild(trackRow);
            });
            
            // Render trains
            const startTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), currentHour, 0);
            
            trains.forEach(train => {
                const trackIndex = tracks.findIndex(t => t.id === train.trackId);
                if (trackIndex === -1) return;
                
                const arrMinutes = (train.arrTime - startTime) / (1000 * 60);
                const depMinutes = (train.depTime - startTime) / (1000 * 60);
                const duration = depMinutes - arrMinutes;
                
                const left = (arrMinutes / 60) * pixelsPerHour;
                const width = (duration / 60) * pixelsPerHour;
                
                const trainDiv = document.createElement('div');
                trainDiv.className = `train-bar type-${train.type}` + (train.hasConflict ? ' has-conflict' : '');
                trainDiv.style.left = left + 'px';
                trainDiv.style.width = width + 'px';
                trainDiv.style.top = (trackIndex * 64) + 'px';
                trainDiv.setAttribute('role', 'button');
                trainDiv.setAttribute('aria-label', `T√•g ${train.number}, ${train.origin} till ${train.dest}`);
                trainDiv.setAttribute('tabindex', '0');
                
                trainDiv.innerHTML = `
                    <div class="train-bar-content">
                        <span class="train-number">${train.number}</span>
                        <span class="train-times">
                            ${train.arrTime.getHours().toString().padStart(2,'0')}:${train.arrTime.getMinutes().toString().padStart(2,'0')}
                            <span class="train-time-separator">‚Üí</span>
                            ${train.depTime.getHours().toString().padStart(2,'0')}:${train.depTime.getMinutes().toString().padStart(2,'0')}
                        </span>
                        <span class="train-route">
                            <span>${train.origin}</span>
                            <span class="train-route-arrow">‚Üí</span>
                            <span>${train.dest}</span>
                        </span>
                    </div>
                    <div class="train-status-indicator ${train.status}"></div>
                    ${train.hasConflict ? '<div class="train-conflict-badge"></div>' : ''}
                    <div class="train-tooltip">
                        ${train.number}: ${train.origin} ‚Üí ${train.dest}<br>
                        Ankomst: ${train.arrTime.toLocaleTimeString('sv-SE', {hour: '2-digit', minute: '2-digit'})}<br>
                        Avg√•ng: ${train.depTime.toLocaleTimeString('sv-SE', {hour: '2-digit', minute: '2-digit'})}<br>
                        Status: ${train.status === 'on-time' ? 'I tid' : train.status === 'delayed' ? 'F√∂rsenad' : 'Inst√§lld'}
                    </div>
                `;
                
                timelineCanvas.appendChild(trainDiv);
            });
            
            // Position current time line
            const nowMinutes = (now - startTime) / (1000 * 60);
            const currentTimeLine = document.getElementById('current-time-line');
            currentTimeLine.style.left = ((nowMinutes / 60) * pixelsPerHour) + 'px';
            
            // Update current time line every minute
            setInterval(() => {
                const now = new Date();
                const minutes = (now - startTime) / (1000 * 60);
                currentTimeLine.style.left = ((minutes / 60) * pixelsPerHour) + 'px';
            }, 60000);
            
            console.log('üìÖ Schedule initialized with', trains.length, 'trains on', tracks.length, 'tracks');
        }
        
        function initializeHeader() {
            // Theme toggle button
            const themeToggleBtn = document.getElementById('theme-toggle-btn');
            if (themeToggleBtn) {
                themeToggleBtn.addEventListener('click', () => {
                    const currentTheme = document.documentElement.getAttribute('data-theme');
                    const newTheme = currentTheme === 'light' ? 'dark' : 
                                    currentTheme === 'dark' ? 'high-contrast' : 'light';
                    setTheme(newTheme);
                });
            }
            
            // Now button
            const nowButton = document.getElementById('now-button');
            if (nowButton) {
                nowButton.addEventListener('click', () => {
                    updateTimeDisplay();
                    console.log('üïê Now button clicked - centering on current time');
                    // TODO: Implement scroll to current time functionality
                });
            }
            
            // Time range selector
            const timeRangeBtn = document.getElementById('time-range-btn');
            const timeRangeDropdown = document.getElementById('time-range-dropdown');
            
            if (timeRangeBtn && timeRangeDropdown) {
                timeRangeBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    timeRangeDropdown.classList.toggle('active');
                });
                
                // Close dropdown when clicking outside
                document.addEventListener('click', () => {
                    timeRangeDropdown.classList.remove('active');
                });
                
                // Time range options
                document.querySelectorAll('.time-range-option').forEach(option => {
                    option.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const hours = option.getAttribute('data-hours');
                        
                        // Update active state
                        document.querySelectorAll('.time-range-option').forEach(opt => {
                            opt.classList.remove('active');
                        });
                        option.classList.add('active');
                        
                        // Update button text
                        timeRangeBtn.querySelector('span').textContent = `${hours}h`;
                        
                        // Close dropdown
                        timeRangeDropdown.classList.remove('active');
                        
                        // Update time range display
                        updateTimeRangeDisplay(parseInt(hours));
                        
                        console.log(`üìè Time range changed to ${hours} hours`);
                    });
                });
            }
            
            // Previous/Next hour buttons
            const prevButtons = document.querySelectorAll('.time-nav button:first-child');
            const nextButtons = document.querySelectorAll('.time-nav button:last-child');
            
            prevButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    console.log('‚èÆ Previous hour');
                    // TODO: Implement navigation
                });
            });
            
            nextButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    console.log('‚è≠ Next hour');
                    // TODO: Implement navigation
                });
            });
        }
        
        function updateTimeDisplay() {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            
            const currentTimeEl = document.getElementById('current-time-display');
            if (currentTimeEl) {
                currentTimeEl.textContent = `${hours}:${minutes}`;
            }
            
            // Update range (default 4 hours)
            const activeRange = document.querySelector('.time-range-option.active');
            const rangeHours = activeRange ? parseInt(activeRange.getAttribute('data-hours')) : 4;
            updateTimeRangeDisplay(rangeHours);
        }
        
        function updateTimeRangeDisplay(hours) {
            const now = new Date();
            const startHour = now.getHours();
            const endHour = (startHour + hours) % 24;
            
            const timeRangeEl = document.getElementById('time-range-display');
            if (timeRangeEl) {
                const startStr = `${String(startHour).padStart(2, '0')}:00`;
                const endStr = `${String(endHour).padStart(2, '0')}:00`;
                timeRangeEl.textContent = `${startStr} - ${endStr}`;
            }
        }
    </script>
</body>
</html>

