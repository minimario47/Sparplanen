/* Timeline header & grid - modern time visualization */

.timeline-canvas {
  position: relative;
  min-width: 100%;
  height: 100%;
  background: var(--neutral-white);
}

[data-theme="dark"] .timeline-canvas {
  background: var(--neutral-950);
}

.timeline-hours {
  position: relative;
  height: 48px;
  background: linear-gradient(to bottom, var(--neutral-100), var(--neutral-50));
  border-bottom: 2px solid var(--neutral-200);
}

[data-theme="dark"] .timeline-hours {
  background: linear-gradient(to bottom, var(--neutral-800), var(--neutral-850));
  border-color: var(--neutral-700);
}
[data-theme="high-contrast"] .timeline-hours {
  background: var(--surface-primary);
  border-bottom: 3px solid var(--border-primary);
}

.timeline-hour {
  position: absolute;
  top: 0;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: var(--spacing-2);
  font-size: var(--text-sm);
  font-weight: var(--font-weight-semibold);
  color: var(--text-primary);
  border-right: 1px solid var(--neutral-200);
  z-index: 1; /* Low z-index so current-time-line (z-index 19) appears above */
}

[data-theme="dark"] .timeline-hour {
  border-color: var(--neutral-700);
}
[data-theme="high-contrast"] .timeline-hour {
  color: var(--text-primary);
  border-right: 2px solid var(--border-primary);
}

.timeline-hour-label {
  font-size: var(--text-base);
  font-weight: var(--font-weight-bold);
  color: var(--text-primary);
}
[data-theme="high-contrast"] .timeline-hour-label { color: var(--text-primary); }

.timeline-hour-period {
  font-size: var(--text-2xs);
  color: var(--text-tertiary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.timeline-hour.current {
  background: var(--primary-100);
}

[data-theme="dark"] .timeline-hour.current {
  background: var(--secondary-600);
}
[data-theme="high-contrast"] .timeline-hour.current {
  background: var(--neutral-700);
  border-right: 2px solid var(--border-primary);
};

.timeline-grid {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

[data-theme="dark"] .timeline-grid-line {
  background: var(--neutral-750);
}

[data-theme="dark"] .timeline-grid-line.hour {
  background: var(--neutral-700);
}

/* This is now just a fallback, as grid lines will be drawn inside each track row */
.timeline-grid-line {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 2px;
    background: var(--neutral-200);
    opacity: 1; /* More visible */
}

.timeline-current-time {
  position: absolute;
  top: 0; /* Position set by JavaScript */
  left: 0; /* Position set by JavaScript */
  width: 4px;
  /* height set by JavaScript to span full canvas */
  background: var(--current-time-color);
  opacity: 0.95;
  z-index: 100; /* Above trains (10-15) and timeline-header (30) */
  pointer-events: none;
  box-shadow:
    0 0 20px var(--current-time-glow-1),
    0 0 40px var(--current-time-glow-2),
    0 0 60px var(--current-time-glow-3);
  animation: pulse-strong 1.5s ease-in-out infinite;
}

@keyframes pulse-strong {
  0%, 100% {
    box-shadow:
      0 0 16px var(--current-time-glow-1),
      0 0 32px var(--current-time-glow-2),
      0 0 48px var(--current-time-glow-3);
  }
  50% {
    box-shadow:
      0 0 24px var(--current-time-glow-1),
      0 0 48px var(--current-time-glow-2),
      0 0 72px var(--current-time-glow-3);
  }
}

.timeline-current-time::before {
  content: "";
  position: absolute;
  top: -10px;
  left: -7px;
  width: 18px;
  height: 18px;
  background: var(--current-time-color);
  border-radius: 50%;
  border: 4px solid var(--neutral-white);
  box-shadow:
    0 4px 12px rgba(0, 0, 0, 0.4),
    0 0 16px var(--current-time-glow-2),
    0 0 24px var(--current-time-glow-3);
}

/* Red time label in timeline hours row - added via JavaScript */
.current-time-label {
  position: absolute;
  top: 50%;
  left: 0;
  transform: translate(-50%, -50%);
  
  /* Maximum strength blurry glass effect with no visible edges */
  background: rgba(255, 255, 255, 0.85);
  backdrop-filter: blur(48px) saturate(400%) brightness(1.2);
  -webkit-backdrop-filter: blur(48px) saturate(400%) brightness(1.2);

  color: var(--text-primary);
  padding: var(--spacing-2) var(--spacing-4);
  border-radius: 20px;
  font-size: var(--font-size-m);
  font-weight: var(--font-weight-bold);
  white-space: nowrap;
  
  /* Ultra-soft, gradual mask to eliminate all edges completely */
  mask-image: radial-gradient(ellipse 200% 150% at center, black 30%, rgba(0,0,0,0.6) 50%, transparent 90%);
  -webkit-mask-image: radial-gradient(ellipse 200% 150% at center, black 30%, rgba(0,0,0,0.6) 50%, transparent 90%);

  z-index: 100; /* Same as current-time-line - always visible above everything except corner */
  height: auto;
  min-height: 28px;
  line-height: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none;
  /* Add dramatic glass shadow visible on timeline below */
  box-shadow:
    0 20px 40px rgba(0,0,0,0.15),
    0 8px 16px rgba(0,0,0,0.1),
    inset 0 1px 0 rgba(255,255,255,0.3),
    0 0 0 20px rgba(255,255,255,0.2),
    0 25px 50px rgba(0,0,0,0.08); /* Extended shadow on timeline */
}

[data-theme="dark"] .current-time-label {
    background: rgba(20, 20, 20, 0.4);
    backdrop-filter: blur(48px) saturate(400%) brightness(0.8);
    -webkit-backdrop-filter: blur(48px) saturate(400%) brightness(0.8);
    color: var(--text-primary);
    box-shadow:
      0 20px 40px rgba(0,0,0,0.4),
      0 8px 16px rgba(0,0,0,0.3),
      inset 0 1px 0 rgba(255,255,255,0.1),
      0 0 0 20px rgba(0,0,0,0.3),
      0 25px 50px rgba(0,0,0,0.2); /* Extended dark shadow on timeline */
}
[data-theme="high-contrast"] .current-time-label {
  background: var(--surface-primary);
  backdrop-filter: none;
  -webkit-backdrop-filter: none;
  border: 2px solid var(--border-primary);
  box-shadow: none;
}

[data-theme="dark"] .timeline-current-time::before {
  border-color: var(--neutral-950);
}

.timeline-track-row {
  position: relative;
  height: auto; /* Allow height to be set dynamically */
  min-height: 48px; /* Reduced to fit all 16 tracks on screen */
  border-bottom: 2px solid var(--neutral-300); /* Darker and thicker track separator */
  transition: background var(--transition-fast);
}

.timeline-track-row:nth-child(even) {
  background: var(--neutral-25);
}

.timeline-track-row:hover {
  background: var(--neutral-50);
}

[data-theme="dark"] .timeline-track-row {
  border-bottom: 2px solid var(--neutral-600); /* Darker track separator in dark mode */
}

[data-theme="dark"] .timeline-track-row:nth-child(even) {
  background: var(--neutral-900);
}

[data-theme="dark"] .timeline-track-row:hover {
  background: var(--neutral-850);
}

/* NEW: Grid lines inside each track row */
.timeline-track-row .grid-line {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 2px;
    background-color: var(--neutral-200); /* Light gray for 15-min lines */
    opacity: 1; /* Fully visible for better readability */
}

/* Hour lines - darker and thicker */
.timeline-track-row .grid-line-hour {
    background-color: var(--neutral-400); /* Darker for hour lines */
}

[data-theme="dark"] .timeline-track-row .grid-line {
    background-color: var(--neutral-700); /* Light gray for dark mode */
}

[data-theme="dark"] .timeline-track-row .grid-line-hour {
    background-color: var(--neutral-500); /* Lighter in dark mode for contrast */
}

[data-theme="high-contrast"] .timeline-track-row .grid-line {
    background-color: var(--neutral-950);
    opacity: 0.3;
}

@media (max-width: 1024px) {
  .timeline-hours {
    height: 40px;
  }
  
  .timeline-hour-label {
    font-size: var(--text-sm);
  }
  
  .timeline-track-row {
    min-height: 44px;
  }
}

@media (max-width: 640px) {
  .timeline-hours {
    height: 36px;
  }
  
  .timeline-hour {
    padding: var(--spacing-1);
  }
  
  .timeline-hour-label {
    font-size: var(--text-xs);
  }
  
  .timeline-hour-period {
    display: none;
  }
  
  .timeline-track-row {
    min-height: 40px;
  }
}

